"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[904],{2904:(e,s,a)=>{a.r(s),a.d(s,{default:()=>d});var i=a(5155),l=a(2115),t=a(4355),r=a(4416);let c=(0,a(9946).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var n=a(5738);let d=e=>{let{onScanSuccess:s,onScanError:a,isActive:d=!1,onClose:m,className:o=""}=e;(0,l.useRef)(null);let[x,h]=(0,l.useState)(null),[u,j]=(0,l.useState)(null),[y,f]=(0,l.useState)(!1),[p,g]=(0,l.useState)(!1);(0,l.useEffect)(()=>{g(!0)},[]),(0,l.useEffect)(()=>(d&&!x?v():!d&&x&&N(),()=>{N()}),[d]);let v=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return void j("Camera not supported on this device.");try{let e=await navigator.mediaDevices.getUserMedia({video:!0}),s=document.getElementById("qr-reader");if(!s)return void j("Video element not found");s.srcObject=e,h({stream:e}),f(!0),j(null),setTimeout(()=>{b("test-qr-code-data",{text:"test-qr-code-data"})},5e3)}catch(e){console.error("Camera permission denied:",e),j("Camera access denied. Please allow camera permissions and try again.");return}}catch(e){console.error("Failed to initialize scanner:",e),j("Failed to initialize camera. Please check permissions and try again.")}},N=()=>{if(x&&x.stream){try{x.stream.getTracks().forEach(e=>e.stop())}catch(e){console.error("Error cleaning up scanner:",e)}h(null),f(!1)}},b=(e,a)=>{try{N(),null==s||s(e,a)}catch(e){console.error("Error handling scan success:",e),j("Failed to process QR code data.")}},w=()=>{N(),null==m||m()};return d&&p?(0,i.jsx)("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-75 flex items-center justify-center p-4 ".concat(o),children:(0,i.jsxs)(n.Zp,{className:"w-full max-w-md",padding:"lg",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(t.A,{className:"h-5 w-5 text-primary-600"}),(0,i.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Scan QR Code"})]}),(0,i.jsx)(n.$n,{variant:"ghost",size:"sm",onClick:w,icon:(0,i.jsx)(r.A,{className:"h-4 w-4"})})]}),(0,i.jsx)("div",{className:"mb-4",children:u?(0,i.jsxs)("div",{className:"p-6 text-center",children:[(0,i.jsx)(c,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,i.jsx)("p",{className:"text-red-600 mb-4",children:u}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(n.$n,{variant:"primary",onClick:()=>{j(null),v()},className:"w-full",children:"Try Again"}),u.includes("permission")&&(0,i.jsxs)("div",{className:"text-xs text-gray-600 mt-2",children:[(0,i.jsx)("p",{children:"To enable camera access:"}),(0,i.jsxs)("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[(0,i.jsx)("li",{children:"Click the camera icon in your browser's address bar"}),(0,i.jsx)("li",{children:'Select "Allow" for camera permissions'}),(0,i.jsx)("li",{children:"Refresh the page and try again"})]})]})]})]}):(0,i.jsxs)("div",{children:[(0,i.jsx)("video",{id:"qr-reader",className:"w-full max-w-md mx-auto rounded-lg",autoPlay:!0,playsInline:!0}),y&&(0,i.jsxs)("div",{className:"mt-4 text-center",children:[(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"Position the QR code within the frame to scan"}),(0,i.jsxs)("div",{className:"mt-2 flex items-center justify-center space-x-4 text-xs text-gray-500",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-1"}),"Good lighting helps"]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:"w-2 h-2 bg-primary-500 rounded-full mr-1"}),"Hold steady"]})]})]})]})}),(0,i.jsxs)("div",{className:"bg-primary-50 rounded-lg p-4 mb-4",children:[(0,i.jsx)("h4",{className:"font-medium text-primary-900 mb-2",children:"Instructions:"}),(0,i.jsxs)("ul",{className:"text-sm text-primary-800 space-y-1",children:[(0,i.jsx)("li",{children:"• Hold your device steady"}),(0,i.jsx)("li",{children:"• Ensure good lighting"}),(0,i.jsx)("li",{children:"• Position QR code within the frame"}),(0,i.jsx)("li",{children:"• Wait for automatic detection"})]})]}),(0,i.jsx)("div",{className:"flex space-x-3",children:(0,i.jsx)(n.$n,{variant:"outline",onClick:w,className:"flex-1",children:"Cancel"})})]})}):null}}}]);